Drools KIE Server Docker image
===============================

Drools KIE Server [Docker](http://docker.io/) image.

More information of KIE Server available at [JBoss documentation](http://docs.jboss.org/drools/release/6.2.0.Final/drools-docs/html/ch19.html).

Table of contents
------------------

* Introduction
* Usage
* Users and roles
* Logging
* Extending this image
* Experimenting
* Notes

Introduction
------------

The image contains: 
              
* JBoss Wildfly 8.1.0.Final             
* Drools KIE Server 6.2.0.Final            

This is a **ready to run Docker image for Drools KIE Server**. Just run it and try our runtime server!

Usage
-----

To run a container:
    
    docker run -P -d --name kie-server jboss/kie-server-showcase:6.2.0.Final

Once container and web applications started, you can navigate to it:              

**Using local host binding port**

If you have run the container using `-P` flag in the `docker` command, the port `8080` has been bind to an available port on your host.                 

So you have to discover your host's bind port, that can be done by running the command:          

    docker ps -a

Example of the above command response:                   

    CONTAINER ID        IMAGE                           COMMAND                CREATED              STATUS              PORTS                                              NAMES
    2a55fbe771c0        jboss/kie-server:6.2.0.Final   ./standalone.sh -b 0   About a minute ago   Up About a minute   0.0.0.0:49159->8080/tcp, 0.0.0.0:49160->9990/tcp   kie-server      

As you can see, the bind port to use for container's port `8080` is `49159`, so you can navigate to:

    http://localhost:49159/kie-server

**No bind port for localhost**

In case you run the container without using `-P` flag in the `docker` command, you can navigate to the application at:

    http://<container_ip_address>:8080/kie-server
    
You can discover the IP address of your running container by:

    docker inspect --format '{{ .NetworkSettings.IPAddress }}' kie-server

The **REST API service** is located at:               

        http://<container_ip_address>:8080/kie-server/services/rest/server/


Users and roles
----------------

This image provides a default user `kie-server` using password `kie-server` and with the role `kie-server`.                      

Logging
-------

You can see all logs generated by the `standalone` binary running:

    docker logs [-f] <container_id>
    
You can attach the container by running:

    docker attach <container_id>

The Drools KIE Server web application logs can be found inside the container at path:

    /opt/jboss/wildfly/standalone/log/server.log

    Example:
    sudo nsenter -t $(docker inspect --format '{{ .State.Pid }}' $(docker ps -lq)) -m -u -i -n -p -w
    -bash-4.2# tail -f /opt/jboss/wildfly/standalone/log/server.log


Experimenting
-------------

To spin up a shell in one of the containers try:

    docker run -t -i -P jboss/kie-server-showcase:6.2.0.Final /bin/bash

You can then noodle around the container and run stuff & look at files etc.

You can run the Drools KIE Server web application by running command:

    /opt/jboss/wildfly/bin/standalone.sh -b 0.0.0.0 --server-config=standalone-full-kie-server.xml


Notes
-----

* Drools KIE Server version is `6.2.0.Final`               
* Drools KIE Server requires running JBoss Wildfly using `full` profile                        
* No support for clustering                
* The context path for Drools KIE Server web application is `kie-server`                  
